<%= form_with(model: @report, url: user_project_reports_path(@user, @project), local: true, method: :post) do |rf| %>
  <div class="box-report pt-5">
    <%= rf.hidden_field :id %>
    <%= rf.hidden_field :user_id %>
    <div class="report-form">
      <span><%= rf.label "件名", class: "mb-0" %></span><span class="report-required">必須</span>
      <%= rf.text_field :title, class:'form-control report-form-color', placeholder: "最大30文字", maxlength: 30, required: true %>
    </div>
    <!-- div class="box-project-select">
      <%#= rf.label :project_id, "プロジェクト", class: "title-label" %>
      <%#= rf.collection_select(:project_id, @projects, :id, :project_name, {selected: @project.id},
      {class: "reprt-project-select-box", data: {user_id: "#{@user.id}", "turbolinks" => false}}) %>
    </div -->
    <% @questions.each do |question| %>
    <%= rf.fields_for :answers do |af|%>
      <%= af.hidden_field :id %>
      <%= af.hidden_field :question_type, value: question.form_table_type %>
      <%= af.hidden_field :question_id, value: question.id%>
      <% case question.form_table_type %>
      <% when 'text_field' %>
        <div class="report-form">
          <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span><span class="report-required">必須</span>
          <%= af.text_field :value, class:'form-control report-form-color', placeholder: "最大30文字", maxlength: 30, required: true %>
        </div>
      <% when 'text_area' %>
        <div class="report-form">
          <% if( question.send(question.form_table_type).label_name == "報告内容" ) %>
            <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span><span class="report-required">必須</span>
            <%= af.text_area :value, class:'form-control report-form-color', placeholder: "最大500文字", maxlength: 500, required: true %>
          <% else %>
            <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span>
            <%= af.text_area :value, class:'form-control report-form-color', placeholder: "最大500文字", maxlength: 500 %>
          <% end %>
        </div>
      <% when 'date_field' %>
        <div class="report-form">
          <div class="col-sm-6 pl-0">
            <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span>
            <%= af.date_field :value, class:'form-control report-form-color' %>
          </div>
        </div>
      <% when 'radio_button' %>
        <div class="report-form">
          <% radio_option = question.radio_button.radio_button_option_strings %>
          <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span><br>
          <%= af.collection_radio_buttons(:value, radio_option, :option_string , :option_string, {}, {}) do |r| %>
            <% r.label(class: "radio-label") { r.radio_button(class: "radio-button") + r.text } %>
          <% end %>
        </div>
      <% when 'select' %>
        <div class="report-form">
          <div class="col-sm-6 pl-0">
            <% select_option = question.select.select_option_strings %>
            <span><%= af.label :value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span>
            <%= af.collection_select(:value, select_option, :option_string, :option_string, {prompt: "選択してください"}, {class: "form-control"}) %>
          </div>
        </div>
      <% when 'check_box' %>
        <div class="report-form">
          <% check_option = question.check_box.check_box_option_strings %>
          <span><%= af.label :array_value, "#{question.send(question.form_table_type).label_name}", class: "mb-0" %></span><br>
          <%= af.collection_check_boxes(:array_value, check_option, :option_string, :option_string, {prompt: "選択してください", include_hidden: false}, {}) do |c| %>
            <% c.label(class: "check-label") { c.check_box(class: "check-button") + c.text } %>
          <% end %>
        </div>
      <% end %>
    <% end %>
    <% end %>
  </div>
  <div class="text-right mt-3">
    <%= rf.submit '投稿', class: "btn btn-outline-orange" %><br>
  </div>
<% end %>
